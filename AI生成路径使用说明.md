# AI生成路径功能使用说明

## 功能概述

AI生成路径功能使用Google Gemini API来自动分析参考平面与牙模的接触点，并生成最优的唇弓路径。这个功能可以帮助用户快速获得符合正畸学原理的路径设计。

## 使用步骤

### 1. 准备工作
- 加载STL牙模文件
- 设置参考平面（点击牙模表面3个点定义平面）
- 确认参考平面

### 2. 进入AI生成模式
- 在设计模式下拉菜单中选择"AI生成路径"
- 系统会自动计算并显示接触点

### 3. 配置AI设置
- **Gemini API密钥**：输入您的Google Gemini API密钥
  - 获取方式：访问 [Google AI Studio](https://makersuite.google.com/app/apikey) 获取免费API密钥
- **自定义Prompt**（可选）：
  - 留空使用默认的专业prompt
  - 或输入自定义指令来指导AI生成特定类型的路径

### 4. 生成路径
- 点击"生成AI路径"按钮
- 系统会调用Gemini API分析接触点
- AI会返回选中的关键点和生成理由
- 自动在3D模型上显示生成的路径

### 5. 导出数据（可选）
- 点击"导出接触点"按钮可以导出接触点数据为JSON文件
- 导出的文件包含接触点坐标、参考平面信息和元数据

## 功能特点

### 智能分析
- AI会分析接触点的分布和密度
- 考虑唇弓的生理曲线特征
- 遵循正畸治疗的最佳路径原则
- 避免过于尖锐的转折

### 灵活配置
- 支持自定义prompt，可以指导AI生成特定类型的路径
- 默认prompt经过专业设计，适合大多数正畸应用场景

### 数据导出
- 可以导出接触点数据供进一步分析
- JSON格式便于与其他工具集成

## 注意事项

1. **API密钥安全**：请妥善保管您的Gemini API密钥，不要在公共场所或不安全的环境中输入
2. **网络连接**：需要稳定的网络连接来调用Gemini API
3. **API限制**：请注意Google Gemini API的使用限制和配额
4. **数据质量**：AI生成的结果质量取决于接触点数据的质量和参考平面的设置

## 故障排除

### 常见问题
1. **"API请求失败: 404"**：
   - 检查API密钥是否正确
   - 确保API密钥有足够的配额
   - 检查网络连接是否正常
   - 系统会自动尝试多个模型，如果都失败请检查API密钥权限

2. **"没有接触点数据"**：确保已正确设置并确认参考平面

3. **"AI响应格式错误"**：尝试使用默认prompt或检查网络连接

4. **"API密钥无效"**：
   - 访问 [Google AI Studio](https://makersuite.google.com/app/apikey) 获取新的API密钥
   - 确保API密钥已启用Gemini API服务
   - 检查API密钥的配额和限制

### 技术支持
如果遇到问题，请检查：
- 浏览器控制台是否有错误信息
- API密钥是否有效
- 网络连接是否正常
- 接触点数据是否充足

## 技术实现

- 使用Google Gemini Pro模型进行AI分析
- 支持自定义prompt和默认专业prompt
- 自动解析AI返回的JSON格式数据
- 集成现有的3D可视化系统
- 支持接触点数据的导入导出
